<div id="outer-container">
  <div id="container">
    <div id="creator-container">
      <form [formGroup]="invoiceForm">
        <div id="form-title">
          <!-- <mat-form-field appearance="standard">
            <input matInput placeholder="Nazwa formularza" formControlName="Form_Title" />
          </mat-form-field> -->
          <span>{{invoiceForm.controls['Form_Title'].value}}</span>
        </div>
        <div id="questions-container" formArrayName="QuestionData">
          <div *ngFor="let question of invoiceForm.controls['QuestionData'].controls; let i = index" [formGroupName]="i" class="question-field">

            <div class="select-container">
              <span>{{question.controls.question.value}}</span>
            </div>

            <div id="field-data" formArrayName="FieldData" [ngSwitch]="question.value.select">
              <div class="field-loop" *ngFor="let field of question.controls.FieldData.controls; let j = index" [formGroupName]="j">

                <div class="choice answer" *ngSwitchCase="'short-answer'">
                  <mat-form-field appearance="standard">
                    <input matInput type="text" formControlName="input" placeholder="Twoja odpowiedź">
                  </mat-form-field>
                </div>

                <div class="choice answer" *ngSwitchCase="'long-answer'">
                  <mat-form-field appearance="standard">
                    <textarea matInput [rows]="1" type="text" formControlName="input" placeholder="Twoja odpowiedź" matTextareaAutosize></textarea>
                  </mat-form-field>
                </div>

                <div class="choice" *ngSwitchCase="'dropdown-menu'" formArrayName="input">
                  <mat-form-field appearance="standard">
                    <mat-select placeholder="Wybierz">
                      <mat-option>Wybierz</mat-option>
                      <div *ngFor="let select of field.controls.input.controls; let k = index" [formGroupName]="k">
                        <mat-option [value]="select.value.value" (click)="updateSelection(field.controls.input.controls, select.controls.value)">
                          {{select.value.viewValue}}
                        </mat-option>
                      </div>
                    </mat-select>
                  </mat-form-field>
                </div>

                <div class="form flex" *ngSwitchCase="'linear-scale'">

                  <div class="div-container">
                    <div class="blank-div"></div>
                    <div class="label-container">
                      <div class="label-div">{{field.value.minLabel}}</div>
                    </div>
                  </div>

                  <div class="table">
                    <div class="columns">
                      <div class="column" *ngFor="let column of field.controls.radios.controls">
                        <div class="label">{{column.value.viewValue}}</div>
                      </div>
                    </div>
                    <div class="rows">
                      <div formArrayName="radios" class="row">
                        <div class="row-container">
                          <div *ngFor="let column of field.controls.radios.controls; let j = index" [formGroupName]="j" class="row-el light">
                            <mat-radio-group formControlName="value" name="{{j}}" (change)="updateSelection(field.controls.radios.controls, column.controls.value ,$event)">
                              <mat-radio-button></mat-radio-button>
                            </mat-radio-group>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>

                  <div class="div-container">
                    <div class="blank-div"></div>
                    <div class="label-container">
                      <div class="label-div">{{field.value.maxLabel}}</div>
                    </div>
                  </div>

                </div>

                <div class="choice" *ngSwitchCase="'single-choice'">
                  <mat-radio-group formControlName="value" name="{{j}}" (change)="updateSelection(question.controls.FieldData.controls, field.controls.value, $event)">
                    <mat-radio-button></mat-radio-button>
                  </mat-radio-group>
                  <mat-form-field appearance="standard">
                    <input matInput type="text" formControlName="viewValue" maxlength="20" #inputs>
                  </mat-form-field>
                </div>

                <div class="choice" *ngSwitchCase="'multiple-choice'">
                  <div class="checkbox" name="check">
                    <div class="right">
                      <mat-checkbox formControlName="value"></mat-checkbox>
                    </div>
                    <mat-form-field appearance="standard">
                      <input matInput type="text" formControlName="viewValue" maxlength="20" #inputs>
                    </mat-form-field>
                  </div>
                </div>

                <div class="form" *ngSwitchCase="'single-grid'">
                  <div class="table">
                    <div class="columns">
                      <div class="column width">
                      </div>
                      <div class="column width" *ngFor="let column of field.controls.rows.controls[j].controls.column.controls">
                        <span>{{column.value.viewValue}}</span>
                      </div>
                    </div>
                    <div formArrayName="rows" class="rows">
                      <div *ngFor="let row of field.controls.rows.controls; let k = index" [formGroupName]="k" class="row">
                        <div formArrayName="column" [ngClass]="k % 2 ? 'row-container dark': 'row-container light'">
                          <div class="row-el width">
                            <span>{{row.value.input}}</span>
                          </div>

                          <div *ngFor="let column of row.controls.column.controls; let l = index" [formGroupName]="l" class="row-el width">
                            <mat-radio-group formControlName="value" name="{{k}}" (change)="updateSelection(row.controls.column.controls, column.controls.value ,$event)">
                              <mat-radio-button></mat-radio-button>
                            </mat-radio-group>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>

                <div class="form" *ngSwitchCase="'multiple-grid'">
                  <div class="table">
                    <div class="columns">
                      <div class="column width">
                      </div>
                      <div class="column width" *ngFor="let column of field.controls.rows.controls[j].controls.column.controls">
                        <span>{{column.value.viewValue}}</span>
                      </div>
                    </div>
                    <div formArrayName="rows" class="rows">
                      <div *ngFor="let row of field.controls.rows.controls; let k = index" [formGroupName]="k" class="row">
                        <div formArrayName="column" [ngClass]="k % 2 ? 'row-container dark': 'row-container light'">
                          <div class="row-el width">
                            <span>{{row.value.input}}</span>
                          </div>
                          <div *ngFor="let column of row.controls.column.controls; let l = index" [formGroupName]="l" class="row-el width">
                            <mat-checkbox formControlName="value"></mat-checkbox>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
          <!-- <pre>{{invoiceForm.value | json }}</pre> -->
          <!-- <pre>{{invoiceForm.controls['QuestionData'].value | json}}</pre> -->
        </div>
      </form>

    </div>

  </div>
</div>
